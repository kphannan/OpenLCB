<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title>Unique Event ID Assignment</title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="824.48">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 16.0px 0.0px; font: 24.0px Times}
    p.p2 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px Times}
    p.p3 {margin: 0.0px 0.0px 7.0px 0.0px; text-align: center; font: 12.0px Times}
    p.p4 {margin: 0.0px 0.0px 12.0px 0.0px; text-align: center; font: 12.0px Times}
    p.p5 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px Lucida Grande}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times}
    p.p7 {margin: 0.0px 0.0px 14.0px 0.0px; font: 14.0px Times}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; min-height: 14.0px}
    p.p9 {margin: 0.0px 0.0px 6.0px 0.0px; font: 12.0px Lucida Grande; min-height: 15.0px}
    span.s1 {text-decoration: underline}
    span.s2 {text-decoration: underline ; color: #0000f0}
    table.t1 {width: 613.0px; margin: 0.0px 77.0px 0.0px 77.0px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #808080 #808080 #808080 #808080}
    td.td1 {width: 62.0px; margin: 1.5px 1.5px 1.5px 1.5px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #808080 #808080 #808080 #808080; padding: 8.0px 8.0px 8.0px 8.0px}
    td.td2 {width: 63.0px; margin: 1.5px 1.5px 1.5px 1.5px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #808080 #808080 #808080 #808080; padding: 8.0px 8.0px 8.0px 8.0px}
    td.td3 {width: 70.0px; margin: 1.5px 1.5px 1.5px 1.5px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #808080 #808080 #808080 #808080; padding: 8.0px 8.0px 8.0px 8.0px}
    td.td4 {width: 438.0px; margin: 1.5px 1.5px 1.5px 1.5px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #808080 #808080 #808080 #808080; padding: 8.0px 8.0px 8.0px 8.0px}
    td.td5 {width: 146.0px; margin: 1.5px 1.5px 1.5px 1.5px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #808080 #808080 #808080 #808080; padding: 8.0px 8.0px 8.0px 8.0px}
    td.td6 {width: 222.0px; margin: 1.5px 1.5px 1.5px 1.5px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #808080 #808080 #808080 #808080; padding: 8.0px 8.0px 8.0px 8.0px}
  </style>
</head>
<body>
<h1 style="margin: 0.0px 0.0px 16.0px 0.0px; font: 24.0px Times"><b>Unique Event ID Assignment</b></h1>
<p class="p2">The proposed OpenLCB depends on globally unique Event ID numbers (EIDs). This node discusses the assignment of those.</p>
<p class="p2">The "globally unique" requirement only refers to the universe of connected nodes; nodes that never need to communicate with each other don't need to have separate Event IDs. In general, however, nodes can move: They can be sold or loaned for use on another layout, nodes on modular layouts can be connected to other arbitrary modules, and few assumptions can be made. Therefore, we require globally uniqueness for all EventIDs.</p>
<p class="p2">To ensure uniqueness, the top 6 bytes of EventIDs that you define are <span class="s1">required</span> to be within the NodeID space that you control. The low two bytes would be any number you prefer, so long as you use each value for only one event.</p>
<p class="p2">This requirement applies equally to events defined by a hardware node, e.g. by button pushing, a software node in a computer, or EventIDs that are defined by a human writing them on a piece of paper. In each case, the thing doing the definition must ensure it has control over the NodeID corresponding to the top four bytes, so it can ensure that the EventID not be reused.</p>
<p class="p3"><i>Table 1: Event Number Construction</i></p>
<table width="613.0" cellspacing="0" cellpadding="0" class="t1">
  <tbody>
    <tr>
      <td valign="middle" class="td1">
        <p class="p4">Byte 1</p>
      </td>
      <td valign="middle" class="td1">
        <p class="p4">Byte 2</p>
      </td>
      <td valign="middle" class="td1">
        <p class="p4">Byte 3</p>
      </td>
      <td valign="middle" class="td1">
        <p class="p4">Byte 4</p>
      </td>
      <td valign="middle" class="td1">
        <p class="p4">Byte 5</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p4">Byte 6</p>
      </td>
      <td valign="middle" class="td2">
        <p class="p4">Byte 7</p>
      </td>
      <td valign="middle" class="td3">
        <p class="p4">Byte 8</p>
      </td>
    </tr>
    <tr>
      <td colspan="6" valign="middle" class="td4">
        <p class="p4">Node ID assigned to you</p>
      </td>
      <td colspan="2" valign="middle" class="td5">
        <p class="p4">Unique 16 bit extension</p>
      </td>
    </tr>
  </tbody>
</table>
<p class="p5"><br>
</p>
<p class="p2">The Node ID part could be e.g. from real nodes that you own. For example, the <a href="file:///Users/dpharris/openlcb/trunk/documents/examples/BlueGoldConfig.html"><span class="s2">Blue/Gold algorithm</span></a> for assigning Event IDs automatically puts the Node ID of the first node to use that event in the Event ID, guaranteeing it to be unique.</p>
<p class="p2">Not all Event IDs need to be assigned through that algorithm. For example, a software configuration tool might define events and assign Event IDs to them. A board manufacturer may prefer some other pushbutton configuration process. A modular club may decide that certain events form the “boundaries” of modules, and need to be assigned well-known Event IDs to make it easier to create large modular layouts. Whatever the method, the Event IDs need to be globally unique, and we ensure that by requiring that people create EventIDs using node ID numbers assigned to them (and therefore not assigned to anybody else), plus an additional 16 bits that they are responsible for using only once.</p>
<p class="p2">Note that the Node ID part of an Event ID doesn't have to correspond to any physical node. So long as you've got some Node ID address space assigned to you, you can use that. For example, a fast-clock manufacturer might want to define a range of EventIDs so that a different event is emitted every fast minute. (This lets e.g. lamp controllers do day-night cycles automatically). For the sake of argument, let's say 24 bits worth of specific events are needed (it's actually smaller, but let's use this). The manufacturer has a large range of node IDs assigned already, so can use 8bits worth of that space, plus the extra 16 bits in the EventID below the nodeID-like-part, to do this. For example, if a manufacturer had a range of Node IDs that included at least 0x123456789A00 through 0x123456789AFF (in other words, all possible values of the low byte), he could create a set of Event IDs with the low 24 bits used to carry a time value:</p>
<p class="p3"><i>Table 2: Example of defining a Set of Events</i></p>
<table width="613.0" cellspacing="0" cellpadding="0" class="t1">
  <tbody>
    <tr>
      <td valign="top" class="td1">
        <p class="p4">Byte 1</p>
      </td>
      <td valign="top" class="td1">
        <p class="p4">Byte 2</p>
      </td>
      <td valign="top" class="td1">
        <p class="p4">Byte 3</p>
      </td>
      <td valign="top" class="td1">
        <p class="p4">Byte 4</p>
      </td>
      <td valign="top" class="td1">
        <p class="p4">Byte 5</p>
      </td>
      <td valign="top" class="td2">
        <p class="p4">Byte 6</p>
      </td>
      <td valign="top" class="td2">
        <p class="p4">Byte 7</p>
      </td>
      <td valign="top" class="td3">
        <p class="p4">Byte 8</p>
      </td>
    </tr>
    <tr>
      <td colspan="6" valign="top" class="td4">
        <p class="p4">Assigned Node ID</p>
      </td>
      <td colspan="2" valign="top" class="td5">
        <p class="p4">Unique 16 bit extension</p>
      </td>
    </tr>
    <tr>
      <td valign="top" class="td1">
        <p class="p4">0x12</p>
      </td>
      <td valign="top" class="td1">
        <p class="p4">0x34</p>
      </td>
      <td valign="top" class="td1">
        <p class="p4">0x56</p>
      </td>
      <td valign="top" class="td1">
        <p class="p4">0x78</p>
      </td>
      <td valign="top" class="td1">
        <p class="p4">0x9A</p>
      </td>
      <td colspan="3" valign="top" class="td6">
        <p class="p4">Time Value</p>
      </td>
    </tr>
  </tbody>
</table>
<p class="p6">This is guaranteed to be unique, no matter where one of these devices is taken, because the node ID range is guaranteed to belong to the manufacturer, and he'll use it only once.</p>
<h3 style="margin: 0.0px 0.0px 14.0px 0.0px; font: 14.0px Times"><b>Well-known Event ID extensions</b></h3>
<p class="p6">Because events are a very convenient way to broadcast information to the entire network, we define some extension values to represent common conditions:</p>
<p class="p8"><br></p>
<p class="p6">0xFFF8 – Node has logged a new log entry (See <a href="file:///Users/dpharris/openlcb/trunk/documents/notes/Logging.html"><span class="s2">logging protocol note</span></a>)</p>
<p class="p6">0xFFF7 -</p>
<p class="p8"><br></p>
<p class="p5"><br>
</p>
<p class="p9"><br></p>
<p class="p2">This is SVN $Revision: 58 $</p>
</body>
</html>
