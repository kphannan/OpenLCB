<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title>Example: Start of Day Operations</title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="824.48">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 16.0px 0.0px; font: 24.0px Times}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times}
    p.p3 {margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px Times}
    p.p4 {margin: 0.0px 0.0px 14.0px 0.0px; font: 18.0px Times}
    p.p5 {margin: 0.0px 0.0px 6.0px 0.0px; font: 12.0px Times; min-height: 14.0px}
  </style>
</head>
<body>
<h1 style="margin: 0.0px 0.0px 16.0px 0.0px; font: 24.0px Times"><b>Example: Start of Day Operations</b></h1>
<p class="p2">These examples discussion various aspects of bringing up an OpenLCB, including adding segments and individual nodes to a running OpenLCB.</p>
<p class="p3">For an OpenLCB that's separated into multiple segments, e.g. several modules on CAN networks connected via an Ethernet backbone, it is likely that the segments will initialize at different times.</p>
<h2 style="margin: 0.0px 0.0px 14.0px 0.0px; font: 18.0px Times"><b>Node Verification</b></h2>
<p class="p2">When a node becomes operational, it sends out an "Initialization Complete" message which other nodes can use to e.g. update status tables, trigger notifications, etc. It follows this with notification of the Event IDs it wants to receive/consume and the ones it is capable of sending/producing.</p>
<p class="p3">When a node comes up, it can check on the existance of other nodes several ways:</p>
<ol>
  <li style="margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times">To check for the existance of a specific node, send a "Verify Node Serial Number (Addressed)" message to the specific node.</li>
  <li style="margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times">To get a list of all currently reachable nodes, send a "Verify Node Serial Number (Unadressed)" message.</li>
  <li style="margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times">To check for the existance of at least one node that produces a specific Event ID, e.g. one consumed by a node, the "Producer Identification" standard interaction can be used. There is no requirement that every Event ID configured into an given consumer exist, so a lack of response to this interaction is not an error, but it can provide useful information.</li>
  <li style="margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times">To check for the existance of at least one node that consumes a specific Event ID, e.g. one produced by a node, the "Consumer Identification" standard interaction can be used. There is no requirement that every Event ID configured into an given producer exist, so a lack of response to this interaction is not an error, but it can provide useful information.</li>
</ol>
<p class="p3">No mechanism is provided to find all the nodes that can be reached by a newly-operational node.</p>
<h2 style="margin: 0.0px 0.0px 14.0px 0.0px; font: 18.0px Times"><b>Configuration Upload</b></h2>
<p class="p2"><i>Is there a need for a mechanism by which a newly-operational node can e.g. upload configuration information, large files (e.g. sounds) or similar? Might be nice to not have to store them locally, particularly with large bandwidth OpenLCBs.</i></p>
<h2 style="margin: 0.0px 0.0px 14.0px 0.0px; font: 18.0px Times"><b>State Restoration</b></h2>
<p class="p2">Producer/Consumer systems react to state changes, which are transferred as Events. When a node first becomes operational, however, it may not have any knowledge of the existing state. It can't figure out how to act until the next external change results in an Event, which is distributed as a PCER message.</p>
<p class="p3">OpenLCB doesn't solve this problem completely for nodes that are powered up individually. They'll operate, but higher level mechanisms are needed for initialization. Those mechanisms can be triggered by e.g. "Initialization Complete" messages from the newly-functional node.</p>
<p class="p3">Several mechanisms are available for implementation:</p>
<ol>
  <li style="margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times">A store-load mechanism can capture and store the state of nodes, and restore those latter. This puts the layout back to the earlier state, but doesn't handle any state changes that have happened since the state was captured.</li>
  <li style="margin: 0.0px 0.0px 12.0px 0.0px; font: 12.0px Times">The current state can be captured via the "Identify Consumers" common message. Restoration of this will restore the output state. Input state changes can be identified with via the "Identify Producers" common message. Non-producer/consumer mechanisms will need separate mechanisms.</li>
  <li style="margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times">The newly-functional node can use the Producer Identification interaction to get "valid" bits from (all) the Producers of the Event IDs that can effect the newly-functional node. This is not fool-proof, however, as not all nodes can produce those, and there might be history (e.g. which Producer fired most recently) that can't be recovered.</li>
</ol>
<p class="p5"><br></p>
<p class="p2">This is SVN $Revision: 52 $</p>
</body>
</html>
