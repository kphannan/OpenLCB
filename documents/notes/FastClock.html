<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>OpenLCB Note: Display Protocol</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.4.1  (Unix)">
	<STYLE TYPE="text/css">
	<!--
		H2.cjk { font-family: "SimSun" }
		H2.ctl { font-family: "Lucida Sans" }
		H3.cjk { font-family: "SimSun" }
		H3.ctl { font-family: "Lucida Sans" }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1>OpenLCB Note: Fast Clocks</H1>
<P>OpenLCB can carry traditional layout fast-clock information in
Events, allowing both display (for people) and Consumers to react
(for automated controls).</P>
<H2 CLASS="western">Environment of Proposal</H2>
<H3 CLASS="western">Requirements</H3>
<P>Must be able to carry the fast time to second resolution. 
</P>
<H3 CLASS="western">Preferences</H3>
<P>Should still work if an implementation needs to send only minute
resolution, e.g. to reduce traffic.</P>
<H3 CLASS="western">Design Points</H3>
<P>Time is sent as “time within today” so that consumers can be
taught to react to time-of-day.  Date is handled separately.</P>
<H2 CLASS="western">Proposed Protocol</H2>
<H3 CLASS="western">Time Event ID format</H3>
<P>A FastClock Time-event is sent every second as [fast_clock_prefix
hh mm ss], with the hours/minutes/seconds encoded in bytes</P>
<H3 CLASS="western">Control Event ID format</H3>
<P>A FC SetRate-event is sent every (10?) seconds as 
[fast_clock_prefix FC|r rr]</P>
<P>A FC SetTime-event is [fast_clock_prefix hh+60 mm]</P>
<P>(The coding for these needs to be explained in more detail)</P>
<P>If a FC Time-event is received, it is ignored.  
</P>
<P>If a FC SetTime event is received, the FC time is set to it.  
</P>
<P>If a FC SetRate-event is received, the rate is set to the rate
embedded in the event.  
</P>
<P>Rate is fixed point rrrrrrrrrr.rr, 0.00, 0.25, 0.50, ..., 999.75</P>
<H3 CLASS="western">Use of Blue/Gold to configure</H3>
<P STYLE="margin-bottom: 0cm">The User Interface (UI) uses the Blue /
Gold buttons:</P>
<UL>
	<LI><P>A (Blue/Gold)+ sequence Sets or Nominates the Time, Rate or
	Alarms to learn a Teach-event.  
	</P>
	<LI><P>Gold(Blue/Gold)+ sequence sends a Teach-event which includes
	the event associated with the current-Time, the Rate-, or any of the
	Alarms.  
	</P>
</UL>
<H2 CLASS="western">Examples</H2>
<P><BR><BR>
</P>
<H2 CLASS="western">Remaining Points</H2>
<P>Does the prefix need to have space in it (a byte?) to identify one
of N clocks?</P>
<P>Alarms?  Should we define a separate set of events that are “this
time is special”?  Any event ID could be produced by any node, upon
receipt of the particular time event, and don't have to be part of
this protocol.  Is something specific for alarms useful, or just
redundancy?</P>
<P>The Arduino clockDisplay example says it contains:</P>
<UL>
	<LI><P>Eight alarms, each can send a FC Alarm-event at its
	associated FC Time.</P>
</UL>
<UL>
	<LI><P>If a FC Alarm-event is received, the clock is set to the time
	associated with that Alarm.</P>
</UL>
<P><BR><BR>
</P>
<P>The use of the same event to <U>broadcast</U> the rate and to <U>set</U>
the rate really needs to be revisited.  Is that consistent with event
semantics?  Or should a “rate set event” do the set and cause the
clock source to emit a “current rate” event?</P>
<HR>
<P>Site hosted by <FONT COLOR="#000080">
<A HREF="http://sourceforge.net/projects/openlcb"><FONT COLOR="#000080"><IMG SRC="http://sflogo.sourceforge.net/sflogo.php?group_id=286373&amp;type=13" NAME="graphics1" ALIGN=ABSMIDDLE WIDTH=120 HEIGHT=30 BORDER=2></FONT></A></FONT>
</P>
<P>This is SVN $Revision$ 
</P>
</BODY>
</HTML>