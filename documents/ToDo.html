<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>OpenLCB To Do: Remaining Questions</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.2  (Unix)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGED" CONTENT="20100728;19594800">
	<META NAME="CHANGEDBY" CONTENT="David Harris">
	<!-- $Id$ -->
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1>To Do: Remaining Questions</H1>
<P>This page is a place to record issues that are still to be
resolved. This is <U>not</U> a place for recording the discussion or
decisions; once a decision is made, it should be implemented in the
documents it affects. In particular, please don't make this a list of
<U>answered</U> questions, those live in the docs we're writing. The
numbering is historical-order; please delete an item that's done, not
renumber below it, so SVN can track progress. If you want to tag
something as high-priority, please use color. Currently, “<SPAN STYLE="background: #99ccff">blue
8</SPAN>” is high-priority documentation tasks, and “<SPAN STYLE="background: #00ff00">light
green</SPAN>” is high-priority implementation tasks. (Feel free to
modify those color chooses, they were picked by a color-challenged
person)</P>
<P>12. First definition and implementation of “<SPAN STYLE="font-style: normal">train
control”, e.g. throttles, etc;</SPAN> define initial protocol. See
<A HREF="notes/LocomotiveControl.html">separate document.</A> <SPAN STYLE="font-style: normal">DCC,
of course, but also allowing for other/future systems. Note that this
is separate from e.g. connections to LocoNet, XpressNet, etc. On MERG
hardware?</SPAN></P>
<P>13. Alex raised the issue of a &quot;layout ID&quot; so e.g.
portable devices (WiFi throttles) can identify which of several
layouts (e.g. at a show) should be joined. See <A HREF="notes/LayoutID.html">working
note</A>. <I>(Does this indicate need for another OpenLCB spec, for
WiFi connection and access? BobJ) (one way to solve this is with
Bonjour/ZeroConf names for access points, separate from anything
OpenLCB-specific. BobJ)</I></P>
<P>17. Still need to think more about &quot;interface Event&quot;
conventions for e.g. large modular layouts. Via XML naming? Via
EventID conventions? Goal is to link next-neighbor modules easily.
Node and Event spaces for modular clubs? [task done] Let them
allocate it using ownership mechanism. Write some examples. <SPAN STYLE="font-style: normal">See
examples/ModularClubs.html note.</SPAN></P>
<P>18. We plan to define a (small number) of “globally known”
events that people can use if they want to. E.g. “power down” or
“emergency stop”, “RFID detector present”, “display
present” (See lighting item 24 below) (item done)(item done) (item
done) How to get those in e.g. Blue/Gold configuration? See item 45.</P>
<P>20. Write an XML-based representation, e.g. as a separate wire
protocol for web services.</P>
<P>22. Signaling (Signalling) – see <A HREF="notes/Signaling.html">initial
Signaling design note</A>, which is currently just a placeholder.</P>
<P>23. Layout Sound Control 
</P>
<OL START=13>
	<P>Alex: (maybe just an adaptation to P/C Events but maybe should be
	identified at least) DPH: I think this is quite straight-forward. It
	includes complex nodes that can send and receive streams, or store
	the sounds, whether in real-time or not. The control of these should
	be straight-forward with events. Things like volume could use Events
	with data to set absolute levels, or increment and decrement Events.
	<I>(Need example doc for this application! - BobJ)</I></P>
</OL>
<P>24. Layout and Room Lighting Control DPH: Bob can probably fill us
in on this one ;-) as he has some experience with X10 and JMRI. Do we
need to do more than suggest some approaches? Maybe an application
note, showing how it could be done? <I>(Define some recommended
events for room intensity, e.g. how to code intensity in event space;
want a mechanism for events to drive specific pre-selected intensity;
study Insteon solution - BobJ)</I></P>
<P><SPAN STYLE="font-style: normal">45. Do we want to define some
node-specific global events? E.g. “Node has logged error”, “Node
has logged warning”; that in turn can e.g. trigger log retrieval.
Others? Can define standard events as NodeID with low of 0xFFFF, etc,
or use a single global Event ID and use the source ID field to know
which event. <A HREF="notes/Logging.html">This has been used in the
Logging note</A> and in the Ident note. Are there other areas that
should be considered? See also item 18.</SPAN></P>
<P>47. Eventually, write some words about a recommended common log
format (mechanism is being developed in Logging note, but not format
of log records)</P>
<P>52. NodeId vs UniqueID terminology, esp. in the EventID
allocation. Notional approach:</P>
<UL>
	<LI><P>Define a space of 48-bit unique IDs. Operationally, this
	means changing the &quot;allocating nodeIDs&quot; document to refer
	to uniqueIDs, not nodeIDs, as the unit of allocation. Require that
	every OpenLCB node be given a unique 48-bit nodeID taken from an
	assigned set of uniqueIDs. 
	</P>
	<LI><P>Require that every OpenLCB producer node be given a block of
	64-bit event IDs such that the values in the most significant 48
	bits of all those event IDs lie within an assigned set of 48-bit
	unique IDs, and none of those event IDs is assigned to more than one
	node.</P>
	<LI><P>Recommend, but don't require, that nodes start assigning
	EventIDs using the uniqueID they're using as their NodeID (most
	people don't need to look at EventID numbers, but being able to
	guess where they came from can be a useful debugging hint)</P>
</UL>
<P>54. Need a CAN boot-loader/IPL process definition. May serve as a
good streaming, datagram example, but it's also possible that full
OpenLCB implementation is too much to include in a bootloader
program. “Dumbest possible node” to receive a bootload? Have a
“bootload me” standard event? “00-00” as special case.
Bootload as CAN-specific, very simple protocol? Delay is a problem,
probably has to be driven from program source, if programming more
than one device at a time.</P>
<P>55. CAN physical layer (cabling, power, etc) has been moved to a
“<A HREF="can/CommonPlatform.html">Common CAN Platform</A>” doc
while the NMRA sees if some compromise is possible there. John Day is
working on this from the OpenLCB-CAN end.</P>
<P><SPAN STYLE="font-style: normal">59. [Task Done] Complete the
“<A HREF="notes/DisplayProtocol.html">Display Protocol</A>” note
and a sample implementation for a display, e.g. of RF or throttle
info.</SPAN></P>
<P STYLE="font-style: normal">61. Clean up the CBUS-hardware PIC
demo. Will this require reimplementing the C/C++ prototype in C? Very
little is actually class based, struct+function might be just fine
anyway.</P>
<P>64. Perhaps add a simple mark/reply out-of-band signal to Streams.
Allow marking a byte as “this byte is marked” (or perhaps “last
byte moved/provided is marked”). Allow sending a no-data reply back
the other way. Useful to prevent people from trying to use buffer
size as a stand-in for e.g. record length (can't count on that size
being anything in particular anyway) Use case is for use in e.g.
bootloader.</P>
<P>67. Create [task done] a [task done] test infrastructure and a
distribution infrastructure for the C/C++ builds.</P>
<P>70. Native format for strings is ASCII, UTF-8 or UTF-16? <FONT FACE="Times New Roman, serif"><FONT SIZE=3>Just
one, or some way of identifying e.g. </FONT></FONT><A HREF="http://en.wikipedia.org/wiki/Byte_Order_Mark"><FONT COLOR="#0842b5"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><U>Byte
Order Mark</U></FONT></FONT></FONT></A> <FONT FACE="Times New Roman, serif"><FONT SIZE=3>(BOM)?
Single bit for ASCII vs UTF-8?</FONT></FONT></P>
<P>71. The examples/CrossingGateExample.html file is a funny hybrid
of general use case, and OpenLCB-specific documentation. It should
probably have the general use case aspects moved to UseCases.html,
with the specifics left in the examples/CrossingGateExample.html
file.</P>
<P>72. David Harris expressed an interest in an early email in some
standard x,y,z mapping for nodes, detectors, etc. Global and/or local
(module specific) reference frame? Make it easy to find a node in
space from it's NodeID? Is this more than just one aspect of a
general system for storing node-specific info? Is it just the
position of the node (hardware) or also items “within” the node,
e.g. the things it's connected to? Start a note....</P>
<P>74. As we write S&amp;RPs, we have to include language along the
lines of “You can't send other messages across the wire except as
defined here”. This avoids people willing the expansion space. To
make this viable, do we have to define “user expansion” message
types? On large-message formats, that's easy, as you can just prepend
a NID you own to identify that you control the message format. Harder
on CAN....</P>
<P><SPAN STYLE="background: #99ccff">75. Blue/Gold and “Event
Configuration” have been split into two documents
(examples/BlueGoldConfig.html,
examples/EventConfigurationProtocol.html). These need to be
rationalized; at least one probably needs to be a note or even in
main document area.</SPAN></P>
<P>77. Finish notes/RouteCases.html doc and link</P>
<P>78. Add definition of flags (error, etc) in datagram, stream
messages in CommonMessageDefinitions.html</P>
<P>80. Discuss mechanism for removing entries from routing tables.
E.g. a router could remember the nodeIDs using a particular event,
then purge those entries if no traffic seen, no response to ping for
NN seconds. Not normative, but might be useful? Mostly for consumers;
if producer gone, doesn't produce.</P>
<P><SPAN STYLE="background: #00ff00">83. Fast clock prototype using
events to display.</SPAN></P>
<P>84. Add examples to the Datagram and Stream protocol docs with
numerical CAN frames, to make the entire layout clear.</P>
<P>85. Simulate Mike Bolton's “50 segments, 100 nodes on each, P/C
32 events each” for startup and traffic.</P>
<P>86. “Ident” protocol (item done) Prototype as part of BG
class, needs to have implementation finished up.</P>
<P>89. Finish up the <A HREF="notes/RFIDusage.html">RFID note</A>.
Prototype. David will work on this. 
</P>
<P>90. Need to add a lot of useful detail to Hobbyist intro so people
can play with code.<BR>DPH: I suggest we novice-proof the code to
some extent. Eg make the code insist on the user defining the
node-id, etc. Also, define the high-order bytes of the node-id such
that it will be a DIY node. Obviously this is easy to get around, but
by then hopefully they are not novices :-). 
</P>
<P>91. Get CAN shields made so hobbyists can use their existing
Arduino hardware? John Plocher may have laid out the PC board. –
this is possible, there are some CAN shields available commercially.
LEDuinos are essentially this, and will be in production soon.
Dependent on (92). We may layout two different connectors – buyers
choice. 
</P>
<P>92. Start to put together a “first standard”, e.g. CAN 125KHz,
connector (see 55) &amp; power (see 57), simple bootloader (see 54),
so manufacturers can build boards. How to handle capacity issues like
min program memory, RAM, CPU speed &amp; type?<BR>John to try to get
agreement on these items with S9.5 and Karl Kobel. 
</P>
<P>93. Movies to tell a story!</P>
<UL>
	<LI><P>Connecting up 1st two nodes; show doing it Without Computer 
	</P>
	<LI><P>Adding another producer; adding another consumer (WC) 
	</P>
	<LI><P>Replacing a node, e.g. due to failure, and reprograming WC 
	</P>
	<LI><P>Programming a yard throat 
	</P>
	<LI><P>Breaking a segment in two; show filtering – could use clock
	or DCC for source of events to be filtered. Filtering fast clock
	messages would show event-ranges. 
	</P>
	<LI><P>DCC connection – David will do: hooking up, using dynamic
	filtering. This may be one button per filter. 
	</P>
	<LI><P>Fast clock events – David will do: Fast clock source, Fast
	clock display, teaching an alarm event. 
	</P>
</UL>
<P><SPAN STYLE="background: #99ccff">94. Document the use of
new-unique EventIDs during “factory reset” and as a way of
“deleting” an even in a producer or consumer.<BR>We need to
discuss this. I think we should implement a Purge which replaces any
native events in use with new native events – I am not sure this is
what is happening now. </SPAN>
</P>
<P><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="background: #99ccff">95.
Document “Datagram start” needed on CAN so that a node can find
the start of the next datagram after rejecting a not-last segment.
See <FONT COLOR="#000000">drawings/CANDatagramProtocolDiagram.odg</FONT></SPAN></FONT></FONT></P>
<P><SPAN STYLE="background: #99ccff">96. Scale Rails article<BR>DPH
will do a first outline and draft. BJ can review and make first
edits. Review by AS, et. </SPAN>
</P>
<P>97. Servo example: People are starting to like servos, they're
cheap and small, so good support for them is distinguishing. Seems to
be well suited to Arduino-style hardware, P/C and our configuration
code. DPH: Lets try to get a real semaphore working – does anyone
have one?</P>
<P>98. Rehost to TCS boards <BR>David H: We need details on:
processor, interfaces, connectors, CAN data rate, power requirements,
etc. Also EDA on boards with complete documentation. BobJ: I'll get
what information is available. At this point, the goal is to show
that OpenLCB can run on this hardware, since the statement has been
made that it can't. I'm not proposing to manufacture these. DPH: I
understand. As long as they have sufficient resources, and a good
C-compiler, we should be able to port over. 
</P>
<P>99. Figure out how to do “Train Forwarding”, an application
described by Reinhard Muller at the NMRA 75 (Milwaukee) meeting.
<BR>DPH: I think this is an application layer problem. It interacts
with auto-topology. Nodes would report loco# on being occupied, and
record it from adjacent blocks' loco-reports. Display is outside our
purview. 
</P>
<P>100. Need tool in C++ prototype for sending arbitrary events
cleanly. Perhaps in PCE?</P>
<P>101. Refactor BG to use e.g. NM for reset and PCE to send ident.</P>
<P>102. C++ prototype Configuration.cpp should use NM to reset node
number, all but node number, etc</P>
<P><SPAN STYLE="background: #99ccff">103. Configuration needs a
discussion of “Setting/resetting node numbers”; also needed in
Event protocol document.</SPAN><BR>DPH: must redo discussion about
originated-events vs non-originated-events. When moving a node to a
new location, the node should be purged of event#s so as not to
spread them into the wild. I think this needs to be a user controlled
operation. Starting all events#=0, and generating a new event#
(originatingNID.ee) as required for teaching, sounds the easiest way
to handle this. Purging is then just zeroing out the event#s. This
does not waste untaught event#s. Working though use-cases is useful:
taking several nodes to the work-bench for set up, and reinstalling
them to the layout; selling a node; lending a node; etc. The term
“purging' seems to be useful, rather than “reset”. BobJ: The
existing spec requires that a reset of the board assign new default
EventIDs. This is about the best you can do: If you clear the board,
you get new ones. You can't build a mechanisms that knows whether an
EventID has been used or not, because it's possible for another node
to enquire about what EventIDs the node has and starting using them
without out telling the node. “EventID == 0” doesn't work for
default eventIDs, because teach/learn need isn't the only way that
you can learn about the EventIDs in a node.</P>
<P><SPAN STYLE="background: #00ff00">104. Finish DCC example from
NMRA meeting</SPAN></P>
<P><SPAN STYLE="background: #00ff00">105. Need Makefile for Arduino
sketches so we can institute a “daily build” process to check for
broken compiles</SPAN></P>
<P><SPAN STYLE="background: #00ff00">106. Reorg to get rid of
symbolic links in SVN for C and Arduino</SPAN></P>
<P>107. Port to mbed. 
</P>
<P>109. A note regarding use of TCP/IP, UDP, etc on Ethernet,
possibly based on <A HREF="http://groups.yahoo.com/group/MRRLCB/message/2702">http://groups.yahoo.com/group/MRRLCB/message/2702</A>,
<A HREF="http://groups.yahoo.com/group/NMRANETWG/message/386">http://groups.yahoo.com/group/NMRANETWG/message/386</A>,
<A HREF="http://groups.yahoo.com/group/NMRANETWG/message/389">http://groups.yahoo.com/group/NMRANETWG/message/389</A>,
and <A HREF="http://groups.yahoo.com/group/NMRANETWG/message/395">http://groups.yahoo.com/group/NMRANETWG/message/395</A>.
</P>
<P>110. Decide whether to allow suppression of particular leading
values (e.g. leading zeros) in the EventID in PCER messages to
conserve bandwidth. <STRIKE><SPAN STYLE="background: transparent">And
whether substituting NIDa for NID, and eliminating when sNID==NIDa,
where possible, is viable as a bandwidth conservation measure. BobJ:
General nodes don't need to know the complete NID ↔ NIDa mapping on
their segment, so to save effort &amp; memory they don't retain it.
(Certain types of ) gateways do need to know it, and it's possible to
create &amp; maintain it, but it's extra work that the average
producer and consumer node doesn't otherwise need to do. If NID →
NIDa transforms were allowed, everybody would have to know how to
invert them, which requires knowing the entire map. Since that can
change, it can't even be stored on a one-time basis. As to
suppressing the NID when it's the same as the source NID, that's the
same issue: The other nodes don't have the whole-NID mapping
available, typically.</SPAN></STRIKE></P>
<P>111. Explore whether raw Ethernet packets is a via option,
possibly only for a one-segment OpenLCB-node only network for meets,
with other Ethernet connections through another separate Ethernet.
(low priority). 
</P>
<P>112.</P>
<P>113.</P>
<P>114.</P>
<P>115.</P>
<P>116.</P>
<P>117.</P>
<P>118.</P>
<P>119.</P>
<P>120.</P>
<HR>
<P>Site hosted by <FONT COLOR="#000080">
<A HREF="http://sourceforge.net/projects/openlcb"><FONT COLOR="#000080"><IMG SRC="http://sflogo.sourceforge.net/sflogo.php?group_id=286373&amp;type=13" NAME="graphics1" ALIGN=ABSMIDDLE WIDTH=120 HEIGHT=30 BORDER=2></FONT></A></FONT>
</P>
<P>This is SVN $Revision$ 
</P>
</BODY>
</HTML>