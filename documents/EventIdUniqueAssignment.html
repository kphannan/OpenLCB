<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>Unique Event ID Assignment</TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.4.1  (Unix)">
	<META NAME="CREATED" CONTENT="0;0">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGED" CONTENT="20130119;19133700">
	<META NAME="Info 1" CONTENT="">
	<META NAME="Info 2" CONTENT="">
	<META NAME="Info 3" CONTENT="">
	<META NAME="Info 4" CONTENT="">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="Bob Jacobsen">
	<META NAME="CHANGEDBY" CONTENT="David Harris">
	<!-- $Id$ -->
	<STYLE TYPE="text/css">
	<!--
		H3.cjk { font-family: "SimSun" }
		H3.ctl { font-family: "Lucida Sans" }
		H2.cjk { font-family: "SimSun" }
		H2.ctl { font-family: "Lucida Sans" }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1>OpenLCB Unique Event ID Assignment</H1>
<P>The proposed OpenLCB depends on globally unique Event ID numbers
(EIDs). This node discusses the assignment of those. 
</P>
<P>The &quot;globally unique&quot; requirement only refers to the
universe of connected nodes; nodes that never need to communicate
with each other don't need to have separate Event IDs. In general,
however, nodes can move: They can be sold or loaned for use on
another layout, nodes on modular layouts can be connected to other
arbitrary modules, and few assumptions can be made. Therefore, we
require globally uniqueness for all EventIDs.</P>
<H2 CLASS="western">Ensuring Uniqueness</H2>
<P>To ensure uniqueness, the top 6 bytes of EventIDs that you define
are <U>required</U> to be within the NodeID space that you control.
The low two bytes would be any number you prefer, so long as you use
each value for only one event.</P>
<P>This requirement applies equally to events defined by a hardware
node, e.g. by button pushing, a software node in a computer, or
EventIDs that are defined by a human writing them on a piece of
paper. In each case, the thing doing the definition must ensure it
has control over the NodeID corresponding to the top four bytes, so
it can ensure that the EventID not be reused.</P>
<P ALIGN=CENTER STYLE="margin-top: 0.21cm; margin-bottom: 0.21cm; page-break-after: avoid">
<FONT SIZE=3><I>Table 1: Event Number Construction</I></FONT></P>
<CENTER>
	<TABLE WIDTH=80% BORDER=1 CELLPADDING=4 CELLSPACING=3 STYLE="page-break-inside: avoid">
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<TR>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 1</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 2</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 3</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 4</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 5</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 6</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 7</P>
			</TD>
			<TD WIDTH=13%>
				<P ALIGN=CENTER>Byte 8</P>
			</TD>
		</TR>
		<TR>
			<TD COLSPAN=6 WIDTH=75%>
				<P ALIGN=CENTER>Node ID assigned to you</P>
			</TD>
			<TD COLSPAN=2 WIDTH=25%>
				<P ALIGN=CENTER>Unique 16 bit extension</P>
			</TD>
		</TR>
	</TABLE>
</CENTER>
<H3 CLASS="western">Using IDs for real nodes</H3>
<P>The Node ID part could be e.g. from real nodes that you own. For
example, the <A HREF="examples/BlueGoldConfig.html">Blue/Gold
algorithm</A> for assigning Event IDs automatically puts the Node ID
of the first node to use that event in the Event ID, guaranteeing it
to be unique.</P>
<H3 CLASS="western">Using allocated IDs</H3>
<P>Not all Event IDs need to be assigned using the IDs of real nodes
that actually exist as hardware. The only requirement is that they be
based on a Node ID owned by the allocator. 
</P>
<P>For example, a software configuration tool might define events and
assign Event IDs to them. A board manufacturer may prefer some other
pushbutton configuration process. A modular club may decide that
certain events form the “boundaries” of modules, and need to be
assigned well-known Event IDs to make it easier to create large
modular layouts. Whatever the method, the Event IDs need to be
globally unique, and we ensure that by requiring that people create
EventIDs using node ID numbers assigned to them (and therefore not
assigned to anybody else), plus an additional 16 bits that they are
responsible for using only once.</P>
<P>Note that the Node ID part of an Event ID doesn't have to
correspond to any physical node. So long as you've got some Node ID
address space assigned to you, you can use that. For example, a
fast-clock manufacturer might want to define a range of EventIDs so
that a different event is emitted every fast minute. (This lets e.g.
lamp controllers do day-night cycles automatically). For the sake of
argument, let's say 24 bits worth of specific events are needed (it's
actually smaller, but let's use this). The manufacturer has a large
range of node IDs assigned already, so can use 8bits worth of that
space, plus the extra 16 bits in the EventID below the
nodeID-like-part, to do this. For example, if a manufacturer had a
range of Node IDs that included at least 0x123456789A00 through
0x123456789AFF (in other words, all possible values of the low byte),
he could create a set of Event IDs with the low 24 bits used to carry
a time value:</P>
<P ALIGN=CENTER STYLE="margin-top: 0.21cm; margin-bottom: 0.21cm; page-break-after: avoid">
<FONT SIZE=3><I>Table 2: Example of defining a Set of Events</I></FONT></P>
<CENTER>
	<TABLE WIDTH=80% BORDER=1 CELLPADDING=4 CELLSPACING=3 STYLE="page-break-inside: avoid">
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<COL WIDTH=32*>
		<TR VALIGN=TOP>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 1</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 2</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 3</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 4</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 5</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 6</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>Byte 7</P>
			</TD>
			<TD WIDTH=13%>
				<P ALIGN=CENTER>Byte 8</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD COLSPAN=6 WIDTH=75%>
				<P ALIGN=CENTER>Assigned Node ID</P>
			</TD>
			<TD COLSPAN=2 WIDTH=25%>
				<P ALIGN=CENTER>Unique 16 bit extension</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>0x12</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>0x34</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>0x56</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>0x78</P>
			</TD>
			<TD WIDTH=12%>
				<P ALIGN=CENTER>0x9A</P>
			</TD>
			<TD COLSPAN=3 WIDTH=38%>
				<P ALIGN=CENTER>Time Value</P>
			</TD>
		</TR>
	</TABLE>
</CENTER>
<P STYLE="margin-bottom: 0cm">This is guaranteed to be unique, no
matter where one of these devices is taken, because the node ID range
is guaranteed to belong to the manufacturer, and he'll use it only
once. 
</P>
<H3 CLASS="western">Well-known Event IDs</H3>
<P STYLE="margin-bottom: 0cm">Because events are a very convenient
way to broadcast information to the entire network, we define some
well-known global event IDs to convey certain kinds of events. As
examples, “global emergency stop”, of interest to all, and “this
node logged a message”, where the specific node can be identified
from the source ID of the event message. These use the node-ID range
that's reserved to OpenLCB itself, and then globally defined lower 16
bits.</P>
<P STYLE="margin-bottom: 0cm">For the entire list, see a separate
<A HREF="../specs/EventIdAllocations.pdf">spreadsheet</A>.</P>
<H3 CLASS="western">Automatically-Routed Event IDs</H3>
<P>Automatically-Routed Event IDs are ones that don't require
Producer Identified and Consumer Identified messages before they'll
be routed throughout the entire system. They are a subset of the well
known IDs. Nodes can, but don't have to, send the Producer Identified
and Consumer Identified messages at startup; nor do they have to
reply to Identify Producer or Identify Consumer. These form a small
subset of the Well-known IDs. For the entire list, see a separate
<A HREF="../specs/EventIdAllocations.pdf">spreadsheet</A>.</P>
<HR>
<P>Site hosted by <FONT COLOR="#000080">
<A HREF="http://sourceforge.net/projects/openlcb"><FONT COLOR="#000080"><IMG SRC="http://sflogo.sourceforge.net/sflogo.php?group_id=286373&amp;type=13" NAME="graphics1" ALIGN=ABSMIDDLE WIDTH=120 HEIGHT=30 BORDER=2></FONT></A></FONT>
</P>
<P>This is SVN $Revision$ 
</P>
</BODY>
</HTML>